---
rule: secret-in-log
name: Secret in log
title: Secret in log
references:
  CWE-532: https://cwe.mitre.org/data/definitions/532.html
impactDomain: Security
labels:
  - secret
  - log
scope: root
---

Identifies when a known or assumed secret is written to a log. Logs are often transported into other
systems that are treated with lesser security - such as backups. Therefore, secrets written into log
files are more likely to be leaked or discovered by cyber-attackers.

### Rule logic

Operation of this rule depends on two labels: `secret` and `log`. A function labeled `secret` is
assumed to return a secret value - this rule keeps a running tally of all the secrets created in an
AppMap. When a function labeled `log` is called, the rule looks at the log message, and checks
whether any of the known secrets are in it.

The log message is also tested against a list of known regular expressions that are likely to match
secrets.

### Notes

Be sure and apply the `secret` label to any function in your code base that generates a secret (such
as encryption keys, user tokens, API keys, reset tokens, etc.).

### Resolution

If the log message is written by code that you control, the simplest resolution is to remove the log
statement - or to remove the secret from the log message.

If the log message is not controlled by you (it's generated by a framework), your choices are more
limited. You could open a pull request with the framework, or you can change the log level to
suppress the offending message.

### Options

None

### Examples

```yaml
- rule: secretInLog
```
