---
rule: too-many-joins
name: Too many joins
title: Too many joins
references:
  CWE-1049: https://cwe.mitre.org/data/definitions/1049.html
impactDomain: Performance
---

Verifies that the number of joins in SQL queries does not exceed a threshold.

### Rule logic

Counts the number of joins in each SQL query. If the count exceeds the configured threshold, a
finding is reported.

### Notes

Queries with too many joins often have poor or unpredictable performance.

### Resolution

Having multiple joins may be legitimate - but it is a situation that merits a closer look,
especially when the query is generated by an ORM.

Take a look at a query plan from a database that has a realistically high volume of data, and verify
that the query can be executed efficiently.

### Options

- `warningLimit` the maximum number of joins allowed.

### Examples

```yaml
- rule: tooManyJoins
  properties:
    warningLimit: 5
```
