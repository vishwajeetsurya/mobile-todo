"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("../../../utils");
const RubyEnv = { APPMAP: 'true', DISABLE_SPRING: 'true' };
const TestCommands = [
    {
        paths: ['Gemfile', 'spec'],
        command: {
            env: RubyEnv,
            command: 'bundle exec rspec',
        },
    },
    {
        paths: ['Gemfile', 'test'],
        command: {
            env: RubyEnv,
            command: 'bundle exec rails test',
        },
    },
    {
        paths: ['pom.xml'],
        command: {
            command: 'mvn test',
            env: {},
        },
    },
    {
        paths: ['package.json', 'node_modules/mocha'],
        command: {
            command: 'npx @appland/appmap-agent-js --recorder=mocha -- npx mocha',
            env: {},
        },
    },
    {
        paths: ['package.json', 'node_modules/@jest'],
        command: {
            command: 'npx @appland/appmap-agent-js --recorder=jest -- npx jest',
            env: {},
        },
    },
];
async function guessTestCommands() {
    const pathExists = await Promise.all(TestCommands.map((guess) => guess.paths).map(async (paths) => Promise.all(paths.map(async (path) => (0, utils_1.exists)(path)))));
    return TestCommands.filter((_, idx) => pathExists[idx].every(Boolean)).map((guess) => guess.command);
}
exports.default = guessTestCommands;
//# sourceMappingURL=guessTestCommands.js.map