"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("./util");
class SecuritySchemes {
    constructor() {
        this.authorizationHeaders = [];
    }
    /**
     * Adds an event to the security schemes, and assigns a security scheme id.
     * If the event has no detectable security scheme, this function returns null.
     */
    addAuthorizationHeader(header) {
        this.authorizationHeaders.push(header);
    }
    openapi() {
        return this.authorizationHeaders.reduce((memo, authorization) => {
            const scheme = (0, util_1.parseScheme)(authorization);
            if (!memo[scheme.schemeId]) {
                memo[scheme.schemeId] = scheme.scheme;
            }
            return memo;
        }, {});
    }
}
exports.default = SecuritySchemes;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VjdXJpdHlTY2hlbWVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3NlY3VyaXR5U2NoZW1lcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLGlDQUFxQztBQUVyQyxNQUFxQixlQUFlO0lBQXBDO1FBQ0UseUJBQW9CLEdBQWEsRUFBRSxDQUFDO0lBbUJ0QyxDQUFDO0lBakJDOzs7T0FHRztJQUNILHNCQUFzQixDQUFDLE1BQWM7UUFDbkMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBRUQsT0FBTztRQUNMLE9BQU8sSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxhQUFhLEVBQUUsRUFBRTtZQUM5RCxNQUFNLE1BQU0sR0FBRyxJQUFBLGtCQUFXLEVBQUMsYUFBYSxDQUFDLENBQUM7WUFDMUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUU7Z0JBQzFCLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQzthQUN2QztZQUNELE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQyxFQUFFLEVBQW9ELENBQUMsQ0FBQztJQUMzRCxDQUFDO0NBQ0Y7QUFwQkQsa0NBb0JDIn0=